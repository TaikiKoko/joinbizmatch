{% extends "base.html" %}

{% block title %}企業マイページ{% endblock %}

{% block extra_css %}
<style>
    :root {
        --primary-color: #2c3e50;
        --secondary-color: #34495e;
        --accent-color: #3498db;
        --background-color: #f8f9fa;
        --card-background: #ffffff;
        --text-primary: #2c3e50;
        --text-secondary: #7f8c8d;
        --border-color: #ecf0f1;
    }

    .container {
        max-width: 800px !important;
        padding: 0 1.5rem;
    }

    .company-header {
        background-color: var(--card-background);
        padding: 1.5rem;
        margin-bottom: 2rem;
        border-radius: 12px;
        box-shadow: 0 2px 4px rgba(0,0,0,.05);
    }

    .company-name {
        font-size: 1.5rem;
        font-weight: 500;
        margin-bottom: 0.5rem;
    }

    .company-description {
        color: var(--text-secondary);
        margin-bottom: 1rem;
    }

    .edit-button {
        padding: 0.25rem 1rem;
        font-size: 0.9rem;
    }

    .tile-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
        margin: 2rem auto;
        max-width: 800px;
    }

    .tile {
        background: white;
        border-radius: 10px;
        padding: 1.5rem;
        text-align: center;
        text-decoration: none;
        color: var(--text-primary);
        transition: transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.8rem;
        position: relative;
        overflow: visible;
    }

    .tile:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        text-decoration: none;
        color: var(--text-primary);
    }

    .tile-icon {
        font-size: 2rem;
        color: var(--primary-color);
    }

    .tile-title {
        font-size: 1.1rem;
        font-weight: 500;
        margin: 0;
    }

    .notification-badge {
        position: absolute;
        top: -10px;
        right: -10px;
        background-color: #e74c3c;
        color: white;
        border-radius: 50%;
        padding: 0.25rem 0.5rem;
        font-size: 0.8rem;
        font-weight: 500;
        min-width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
    }
</style>
{% endblock %}

{% block content %}
<div class="company-header">
    <h1 class="company-name">{{ current_user.company.name }}</h1>
    <p class="company-description">{{ current_user.company.business_description }}</p>
    <a href="{{ url_for('profile.edit_company_profile') }}" class="btn btn-outline-primary edit-button">
        <i class="fas fa-edit"></i> プロフィールを編集
    </a>
</div>

<div class="tile-grid">
    <a href="{{ url_for('main.successor_list') }}" class="tile">
        <i class="fas fa-search tile-icon"></i>
        <h3 class="tile-title">後継者を探す</h3>
    </a>
    
    <a href="{{ url_for('main.company_favorites') }}" class="tile">
        <i class="fas fa-star tile-icon"></i>
        <h3 class="tile-title">お気に入り</h3>
    </a>
    
    <a href="{{ url_for('main.message_list') }}" class="tile" id="message-tile">
        <i class="fas fa-envelope tile-icon"></i>
        <h3 class="tile-title">メッセージ</h3>
        <span id="unread-message-badge" class="notification-badge" {% if unread_messages_count == 0 %}style="display:none;"{% endif %}>
            {{ unread_messages_count }}
        </span>
    </a>
    
    <a href="{{ url_for('main.notifications') }}" class="tile">
        <i class="fas fa-bell tile-icon"></i>
        <h3 class="tile-title">お知らせ</h3>
        {% if unread_notifications_count > 0 %}
        <span class="notification-badge">{{ unread_notifications_count }}</span>
        {% endif %}
    </a>
    
    <a href="{{ url_for('main.notes') }}" class="tile">
        <i class="fas fa-sticky-note tile-icon"></i>
        <h3 class="tile-title">メモ</h3>
    </a>
    
    <a href="{{ url_for('main.blocked_users') }}" class="tile">
        <i class="fas fa-ban tile-icon"></i>
        <h3 class="tile-title">ブロックリスト</h3>
    </a>
    
    <a href="{{ url_for('main.settings') }}" class="tile">
        <i class="fas fa-cog tile-icon"></i>
        <h3 class="tile-title">設定</h3>
    </a>
</div>
{% endblock %}

{% block extra_js %}
<script>
window.chatConfig = {
    currentUserId: {{ current_user.id|tojson }}
};
</script>
<script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
<script src="{{ url_for('static', filename='js/chat_rooms.js') }}"></script>
{% endblock %} 